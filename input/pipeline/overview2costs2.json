[
    [
        {
            "$": "load",
            "from": "AnnualVariableOperatingCost",
            "sharding": [
                "Scenario"
            ]
        },
        {
            "$": "new-column",
            "type": "relationship",
            "name": "CostType",
            "value": "VAR"
        },
        {
            "$": "save-temp",
            "to": "#VariableCost"
        }
    ],
    [
        {
            "$": "load",
            "from": "AnnualFixedOperatingCost",
            "sharding": [
                "Scenario"
            ]
        },
        {
            "$": "new-column",
            "type": "relationship",
            "name": "CostType",
            "value": "FIX"
        },
        {
            "$": "save-temp",
            "to": "#FixedCost"
        }
    ],
    [
        {
            "$": "load",
            "from": "CapitalInvestment",
            "sharding": [
                "Scenario"
            ]
        },
        {
            "$": "new-column",
            "type": "relationship",
            "name": "CostType",
            "value": "CAPINV"
        },
        {
            "$": "save-temp",
            "to": "#CapitalInvestment"
        }
    ],
    [
        {
            "$": "load-temp",
            "from": "#VariableCost"
        },
        {
            "$": "union",
            "with-temp": "#FixedCost"
        },
        {
            "$": "union",
            "with-temp": "#CapitalInvestment"
        },
        {
            "$": "aggregate",
            "groupby": [
                "CostType",
                "YEAR"
            ]
        },
        {
            "$": "save-temp",
            "to": "#ByCostType"
        }
    ],
    [
        {
            "$": "load-temp",
            "from": "#ByCostType"
        },
        {
            "$": "aggregate",
            "groupby": [
                "YEAR"
            ]
        },
        {
            "$": "new-column",
            "type": "relationship",
            "name": "CostType",
            "value": "TOT"
        },
        {
            "$": "union",
            "with-temp": "#ByCostType"
        },
        {
            "$": "save",
            "to": "Overview2",
            "sharding": [
                "Scenario"
            ]
        }
    ],
    [
        {
            "$": "load-temp",
            "from": "#FixedCost"
        },
        {
            "$": "union",
            "with-temp": "#CapitalInvestment"
        },
        {
            "$": "filter",
            "column": ":TECHNOLOGY:Sector",
            "in": [
                "TRA",
                "HPROD"
            ]
        },
        {
            "$": "aggregate",
            "groupby": [
                "YEAR",
                "CostType"
            ]
        },
        {
            "$": "save",
            "to": "Costs2",
            "sharding": [
                "Scenario"
            ],
            "stats": [
                {
                    "method": "chart",
                    "type": "area",
                    "stacked": true,
                    "stackOffset": "sign",
                    "groupby": [
                        "Scenario",
                        "YEAR"
                    ]
                }
            ]
        }
    ]
]